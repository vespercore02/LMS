{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block body %}

<style>
    .news {
        height: 300px;
        max-height: 330px;
        overflow-y: scroll;
        background: ivory;
    }

    .news::-webkit-scrollbar {
        width: .5em;
    }

    .news::-webkit-scrollbar-track {
        -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    }

    .news::-webkit-scrollbar-thumb {
        background-color: darkgrey;
        outline: 1px solid slategrey;
    }
</style>


<div class="col-sm-2">

</div>
<div class="col-sm-8">

    <div class="card mb-4">
        <div class="card-body">
            <h1 class="mb-4">Welcome</h1>

            {% if current_user %}
            <div class="text-center">
                {{ current_user.name }}

            </div>
            {% else %}
            <a href="/signup/new">Sign up</a> or <a href="/login">log in</a>.
            {% endif %}
        </div>
    </div>

    {% if current_user %}
    {% if current_user.access_rights == 0 %}
    {% include 'LoanRecords.html '%}

    {% elseif current_user.access_rights == 1 %}

    {% include 'ContriRecords.html '%}
    {% include 'LoanRecords.html '%}

    {% elseif current_user.access_rights == 2 %}

    {% include 'GroupRecords.html '%}

    {% elseif current_user.access_rights == 9 %}

    <div class="card mb-4">
        <div class="card-body">

            <div class="text-center mb-4">


                <h4>Admin Tools</h4>


            </div>
            <div class="form-group row mb-3">

                <div class="col-sm-1"></div>

                <button class="btn btn-success col-sm-4"
                    onclick="location.href='/admin/users/members';">Members</button>


                <div class="col-sm-2"></div>

                <button class="btn btn-success col-sm-4" onclick="location.href='/admin/users/loan-form';">Loan
                    Form</button>

                <div class="col-sm-1"></div>
            </div>

            <div class="form-group row mb-3">

                <div class="col-sm-1"></div>

                <button class="btn btn-success col-sm-4" onclick="location.href='/admin/users/groups';">Groups</button>

                <div class="col-sm-2"></div>

                <button class="btn btn-success col-sm-4"
                    onclick="location.href='/admin/users/announcement-form';">Announcement Form</button>

                <div class="col-sm-1"></div>
            </div>

            <div class="form-group row mb-3">

                <div class="col-sm-1"></div>

                <button class="btn btn-success col-sm-4" onclick="location.href='/admin/users/access';">Access</button>

                <div class="col-sm-2"></div>



                <div class="col-sm-1"></div>
            </div>
        </div>
    </div>

    {% endif %}






    {% endif %}

</div>
<div class="col-sm-2">

</div>
{% endblock %}

{% block javascript %}
<script>

    $(document).ready(function () {
        var controller, month, group
        $('select[name=month]').on('change', function () {
            var optionSelected = $(this).val();
            var valueSelected = this.value;

            //alert(optionSelected+" {{current_user.belonging_group}}");
            //selectedMonthContri(optionSelected, "{{current_user.belonging_group}}");
            month = optionSelected;

            group = $("input[name=belonging_group").val();

            showTable();

            getData(group, month)
        });

        function getData(group, month) {
            $.get("home/groupmonthdetails", { month: month, group: group }).done(function (data) {
                var i;
                data = JSON.parse(data);
                $('tbody.grp_mmbrs_cntr').empty();
                for (i = 0; i < data.length; i++) {
                    //const element = array[index];
                    //console.log(data[i][0]);
                    dataDetails = {
                        name: data[i][0],
                        contri: data[i][1],
                        estimated_earning: data[i][2],
                        actual_earning: data[i][3],
                        contri_plus_earning: data[i][4]
                    };
                    console.log(dataDetails);
                    $('tbody.grp_mmbrs_cntr').append(
                        '<tr>' +
                        '<td>' + dataDetails.name + '</td>' +
                        '<td>' + dataDetails.contri + '</td>' +
                        '<td>' + dataDetails.estimated_earning + '</td>' +
                        '<td>' + dataDetails.actual_earning + '</td>' +
                        '<td>' + dataDetails.contri_plus_earning + '</td>' +
                        '<tr>'
                    );

                }



            });
        }

        function showTable() {

        }


    });


</script>

{% endblock %}